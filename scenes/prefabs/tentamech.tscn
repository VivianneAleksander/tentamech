[gd_scene load_steps=24 format=3 uid="uid://d43jvw5r31qx"]

[ext_resource type="PackedScene" uid="uid://dee56bhfxqip5" path="res://assets/meshes/tentamech.glb" id="1_ik0fc"]
[ext_resource type="Material" uid="uid://cuakkhn75dlen" path="res://assets/materials/tentamech_body.tres" id="2_6kx7t"]
[ext_resource type="Material" uid="uid://bcebdedm6l3i1" path="res://assets/materials/tentamech_windshield.tres" id="3_pvmjk"]
[ext_resource type="PackedScene" uid="uid://bgcae7sh45881" path="res://scenes/prefabs/tentamech_particles.tscn" id="4_6yynb"]
[ext_resource type="Script" path="res://scripts/player_control/mouse_follow_behavior.gd" id="5_jmmn4"]
[ext_resource type="PackedScene" uid="uid://3n4rcjl27tv0" path="res://scenes/prefabs/tentamech_bullets_01.tscn" id="5_sw3cs"]
[ext_resource type="Script" path="res://scripts/util/animation_values_manager.gd" id="6_4hkth"]
[ext_resource type="Script" path="res://scripts/player_control/animation_values/turned.gd" id="7_p6gu3"]
[ext_resource type="Script" path="res://scripts/player_control/animation_values/firing.gd" id="8_02dgv"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_p5rrw"]
animation = &"Fire"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3op0i"]
animation = &"Fire02"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_0kg6d"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_cu7at"]
animation = &"Idle02"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_t7wda"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_s7n1v"]
switch_mode = 1
advance_mode = 2
advance_condition = &"turned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_68bfu"]
switch_mode = 1
advance_mode = 2
advance_condition = &"not_turned"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_smy2t"]
advance_mode = 2
advance_condition = &"firing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_gotgm"]
advance_mode = 2
advance_condition = &"not_firing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_xc6as"]
advance_mode = 2
advance_condition = &"firing"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_if7qd"]
advance_mode = 2
advance_condition = &"not_firing"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_fixs7"]
states/Fire/node = SubResource("AnimationNodeAnimation_p5rrw")
states/Fire/position = Vector2(502.6, 130.184)
states/Fire02/node = SubResource("AnimationNodeAnimation_3op0i")
states/Fire02/position = Vector2(502.898, 250.322)
states/Idle/node = SubResource("AnimationNodeAnimation_0kg6d")
states/Idle/position = Vector2(359, 130.2)
states/Idle02/node = SubResource("AnimationNodeAnimation_cu7at")
states/Idle02/position = Vector2(359.067, 250.424)
states/Start/position = Vector2(250.4, 14.4)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_t7wda"), "Idle", "Idle02", SubResource("AnimationNodeStateMachineTransition_s7n1v"), "Idle02", "Idle", SubResource("AnimationNodeStateMachineTransition_68bfu"), "Idle", "Fire", SubResource("AnimationNodeStateMachineTransition_smy2t"), "Fire", "Idle", SubResource("AnimationNodeStateMachineTransition_gotgm"), "Idle02", "Fire02", SubResource("AnimationNodeStateMachineTransition_xc6as"), "Fire02", "Idle02", SubResource("AnimationNodeStateMachineTransition_if7qd")]
graph_offset = Vector2(83, 38)

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_4rd6t"]
graph_offset = Vector2(-145.739, 196.364)
nodes/StateMachine/node = SubResource("AnimationNodeStateMachine_fixs7")
nodes/StateMachine/position = Vector2(32, 192)
node_connections = [&"output", 0, &"StateMachine"]

[sub_resource type="SphereShape3D" id="SphereShape3D_in1du"]

[node name="Tentamech" type="Area3D"]

[node name="tentamech" parent="." instance=ExtResource("1_ik0fc")]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 0.832464, 0.333301, 0.130519)

[node name="Skeleton3D" parent="tentamech/TentamechArmature" index="0"]
bones/0/rotation = Quaternion(-0.707107, 0, 0, 0.707107)
bones/1/position = Vector3(1.37323, -0.79134, -0.497546)
bones/1/rotation = Quaternion(0.00431485, 0.9579, -0.0781388, 0.276231)
bones/1/scale = Vector3(1, 1.00028, 1)
bones/2/rotation = Quaternion(-2.34527e-08, 0.519371, -9.92075e-07, 0.854549)
bones/3/scale = Vector3(1, 1.01448, 1)
bones/4/rotation = Quaternion(7.36302e-08, -0.0389013, -1.67765e-07, 0.999243)
bones/4/scale = Vector3(1, 0.843162, 1)
bones/5/scale = Vector3(1, 0.865699, 1)
bones/6/scale = Vector3(1, 0.955081, 1)
bones/7/scale = Vector3(1, 1.10367, 1)
bones/8/rotation = Quaternion(6.3321e-08, 0.998189, 3.45878e-07, -0.0601528)
bones/8/scale = Vector3(1, 1.09213, 1)
bones/9/scale = Vector3(1, 0.645561, 1)
bones/10/scale = Vector3(1, 1.28661, 1)
bones/11/scale = Vector3(1, 1.28661, 1)
bones/12/rotation = Quaternion(9.33385e-08, 0.937923, 2.22424e-07, 0.346844)
bones/12/scale = Vector3(1, 1.09097, 1)
bones/13/scale = Vector3(1, 1.09097, 1)
bones/14/position = Vector3(0.653014, -0.76031, 0.799028)
bones/14/rotation = Quaternion(-0.183771, -0.322766, 0.922418, -0.105808)
bones/14/scale = Vector3(1, 1, 1)
bones/16/position = Vector3(0, 0.260263, 0.100756)
bones/16/rotation = Quaternion(0.697305, 0, 0, 0.716774)
bones/16/scale = Vector3(1, 0.984433, 1)
bones/18/rotation = Quaternion(0.837847, -9.76767e-09, 2.50319e-08, 0.545905)
bones/18/scale = Vector3(1, 1.0026, 1.01325)
bones/19/rotation = Quaternion(0.172223, 0.940749, 0.103963, -0.272987)
bones/20/rotation = Quaternion(-0.234847, -0.214789, -0.0589098, 0.946172)
bones/21/rotation = Quaternion(-0.356279, 0.335913, -0.0972036, 0.866475)
bones/21/scale = Vector3(1, 1, 1)
bones/22/rotation = Quaternion(-0.285369, 0.0184051, -0.124541, 0.950113)
bones/23/rotation = Quaternion(-0.246519, 0.0327218, -0.0491612, 0.967337)
bones/23/scale = Vector3(1, 1, 1)
bones/24/rotation = Quaternion(-0.193731, 0.024282, -0.0261515, 0.980406)
bones/24/scale = Vector3(1, 1, 1)
bones/25/rotation = Quaternion(0.0324097, 0.0968653, 0.00575754, 0.994753)
bones/27/rotation = Quaternion(0.0136742, 0.911124, 0.0658024, 0.406616)
bones/27/scale = Vector3(1, 1, 1)
bones/28/rotation = Quaternion(-0.235536, -0.0776972, 0.198297, 0.948243)
bones/28/scale = Vector3(1, 1, 1)
bones/29/rotation = Quaternion(-0.259276, 0.397542, 0.108858, 0.873434)
bones/29/scale = Vector3(1, 1, 1)
bones/30/rotation = Quaternion(-0.213751, -6.67191e-05, 0.00641005, 0.976867)
bones/30/scale = Vector3(1, 1, 1)
bones/31/rotation = Quaternion(-0.217719, 0.00701772, 0.0184535, 0.975812)
bones/32/rotation = Quaternion(-0.27307, 0.017187, 0.0408134, 0.960974)
bones/33/rotation = Quaternion(-0.0811961, 0.0753542, -0.000420136, 0.993845)
bones/35/rotation = Quaternion(0.00517126, 0.782544, 0.239047, 0.574851)
bones/35/scale = Vector3(1, 1, 1)
bones/36/rotation = Quaternion(-0.238971, -0.104806, 0.314301, 0.912756)
bones/37/rotation = Quaternion(-0.23311, 0.379787, 0.168678, 0.879187)
bones/37/scale = Vector3(1, 1, 1)
bones/38/rotation = Quaternion(-0.114858, -0.0140408, 0.0273246, 0.992907)
bones/39/rotation = Quaternion(-0.095185, -0.0135874, 0.020979, 0.995146)
bones/40/rotation = Quaternion(-0.206759, -0.0243884, 0.0276349, 0.977697)
bones/40/scale = Vector3(1, 1, 1)
bones/41/rotation = Quaternion(-0.0600113, 0.0502932, 0.148343, 0.985831)
bones/43/rotation = Quaternion(0.13002, 0.837395, 0.376698, 0.374115)
bones/44/rotation = Quaternion(-0.130953, -0.00245749, 0.129339, 0.982912)
bones/44/scale = Vector3(1, 1, 1)
bones/45/rotation = Quaternion(-0.259954, 0.412998, 0.0956564, 0.867586)
bones/45/scale = Vector3(1, 1, 1)
bones/46/rotation = Quaternion(-0.258594, 0.00357029, -0.0179424, 0.965813)
bones/47/rotation = Quaternion(-0.16414, 0.00359542, -0.00538717, 0.986416)
bones/47/scale = Vector3(1, 1, 1)
bones/48/rotation = Quaternion(-0.169621, 0.00446581, 0.0214316, 0.985266)
bones/49/rotation = Quaternion(0.0487354, 0.0449402, 0.0616017, 0.995897)
bones/49/scale = Vector3(1, 1, 1)
bones/51/position = Vector3(-1.23464, 0.497357, -0.376851)
bones/51/rotation = Quaternion(0.000151637, 0.959038, -0.0626419, -0.276265)
bones/51/scale = Vector3(1, 1.05771, 1)
bones/52/rotation = Quaternion(-5.45673e-07, 0.0118795, 8.3191e-07, 0.999929)
bones/53/scale = Vector3(1, 1.01448, 1)
bones/54/rotation = Quaternion(7.36302e-08, 0.0389013, 1.67765e-07, 0.999243)
bones/54/scale = Vector3(1, 1.09097, 1)
bones/55/scale = Vector3(1, 1.28661, 1)
bones/56/scale = Vector3(1, 1.28661, 1)
bones/57/scale = Vector3(1, 0.985003, 1)
bones/58/rotation = Quaternion(-7.4641e-08, 0.998189, 3.61076e-07, 0.0601527)
bones/58/scale = Vector3(1, 1.10367, 1)
bones/59/rotation = Quaternion(-1.68337e-07, 0.931082, 2.09405e-07, -0.36481)
bones/59/scale = Vector3(1, 0.978798, 1)
bones/60/scale = Vector3(1, 0.955081, 1)
bones/61/scale = Vector3(1, 0.865699, 1)
bones/62/rotation = Quaternion(-8.87828e-08, 0.937923, 2.32095e-07, -0.346844)
bones/62/scale = Vector3(1, 0.843162, 1)
bones/63/scale = Vector3(1, 1.09097, 1)
bones/64/position = Vector3(-0.658589, -0.158284, 1.36764)
bones/64/rotation = Quaternion(0.155543, -0.299852, 0.925117, 0.173358)
bones/64/scale = Vector3(1, 1, 1)
bones/66/position = Vector3(1.38563, 0.469363, -1.99356)
bones/67/position = Vector3(-0.266552, -0.0414818, -2.3325)
bones/67/rotation = Quaternion(-0.0219391, 0.706766, 0.706766, -0.0219391)
bones/68/position = Vector3(-1.18898, 0.380358, -1.77473)
bones/68/rotation = Quaternion(-0.110506, 0.698419, 0.698419, -0.110506)
bones/68/scale = Vector3(1, 1, 1)
bones/69/position = Vector3(0.011574, 0.831427, -1.79856)
bones/69/rotation = Quaternion(-0.0180203, 0.706877, 0.706877, -0.0180203)
bones/69/scale = Vector3(1, 1, 1)

[node name="Tentamech" parent="tentamech/TentamechArmature/Skeleton3D" index="0"]
surface_material_override/0 = ExtResource("2_6kx7t")
surface_material_override/1 = ExtResource("3_pvmjk")

[node name="RocketFlameRAttachment" type="BoneAttachment3D" parent="tentamech/TentamechArmature/Skeleton3D" index="1"]
transform = Transform3D(-0.910066, 0.313829, -0.270724, -0.407329, -0.556561, 0.724101, 0.0765692, 0.769254, 0.634339, 0.978823, 0.13834, 1.82019)
bone_name = "RocketFlame.R"
bone_idx = 15

[node name="TentamechRocketParticles" parent="tentamech/TentamechArmature/Skeleton3D/RocketFlameRAttachment" instance=ExtResource("4_6yynb")]

[node name="RocketFlameLAttachment" type="BoneAttachment3D" parent="tentamech/TentamechArmature/Skeleton3D" index="2"]
transform = Transform3D(-0.891506, -0.414033, 0.183828, 0.391755, -0.500867, 0.771791, -0.227473, 0.760072, 0.608725, -1.08843, 0.764774, 1.20863)
bone_name = "RocketFlame.L"
bone_idx = 65

[node name="TentamechRocketParticles" parent="tentamech/TentamechArmature/Skeleton3D/RocketFlameLAttachment" instance=ExtResource("4_6yynb")]

[node name="MinigunRootRAttachment" type="BoneAttachment3D" parent="tentamech/TentamechArmature/Skeleton3D" index="3"]
transform = Transform3D(-0.859367, 0.0514474, -0.508767, 0.49734, -0.147355, -0.854957, -0.118922, -0.988024, 0.101017, 1.41636, -0.703975, 0.22421)
bone_name = "MinigunRoot.R"
bone_idx = 2

[node name="TentamechBullets01" parent="tentamech/TentamechArmature/Skeleton3D/MinigunRootRAttachment" instance=ExtResource("5_sw3cs")]
transform = Transform3D(1, 0, 0, 0, 0.992546, 0.121869, 0, -0.121869, 0.992546, 0, 0, 0)

[node name="MinigunRootLAttachment" type="BoneAttachment3D" parent="tentamech/TentamechArmature/Skeleton3D" index="4"]
transform = Transform3D(-0.834527, -0.0362995, -0.549898, 0.549673, -0.127175, -0.826682, -0.0377468, -1.04941, 0.119204, -1.26507, -0.566361, -1.11596)
bone_name = "MinigunRoot.L"
bone_idx = 52

[node name="TentamechBullets02" parent="tentamech/TentamechArmature/Skeleton3D/MinigunRootLAttachment" instance=ExtResource("5_sw3cs")]
transform = Transform3D(1, 0, 0, 0, 0.992546, 0.121869, 0, -0.121869, 0.992546, 0, 0, 0)

[node name="AnimationTree" type="AnimationTree" parent="tentamech"]
tree_root = SubResource("AnimationNodeBlendTree_4rd6t")
anim_player = NodePath("../AnimationPlayer")
parameters/StateMachine/conditions/firing = true
parameters/StateMachine/conditions/not_firing = false
parameters/StateMachine/conditions/not_turned = false
parameters/StateMachine/conditions/turned = false

[node name="AnimationValuesManager" type="Node" parent="tentamech/AnimationTree"]
script = ExtResource("6_4hkth")

[node name="DirectionValue" type="Node" parent="tentamech/AnimationTree/AnimationValuesManager" node_paths=PackedStringArray("follow_control")]
script = ExtResource("7_p6gu3")
follow_control = NodePath("../../../../MouseFollowBehavior")
value_name = &"turned"
also_set_inverse = true

[node name="FiringValue" type="Node" parent="tentamech/AnimationTree/AnimationValuesManager"]
script = ExtResource("8_02dgv")
value_name = &"firing"
also_set_inverse = true

[node name="MouseFollowBehavior" type="Node" parent="." node_paths=PackedStringArray("target")]
script = ExtResource("5_jmmn4")
target = NodePath("..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("SphereShape3D_in1du")

[node name="SpotLight3D" type="SpotLight3D" parent="."]
transform = Transform3D(0.122028, -0.868034, 0.481275, 0.567904, 0.458743, 0.683402, -0.813999, 0.189924, 0.54894, 3.84678, 5.20025, 4.08011)
spot_range = 45.102
spot_attenuation = -0.1
spot_angle = 37.91
spot_angle_attenuation = 2.37842

[editable path="tentamech"]
